{% extends "agent/case-manager-review/includes/layout.html" %}

{% block pageTitle %} View all awarded claims {% endblock %}

{% set pageStatus="Work in progress" %}
{% set teamName="Pelican" %}
{% set pageNotes="New page" %}

{% block main %}

<div class="govuk-width-container">

<!-- <a href="javascript:history.go(-1)" class="govuk-back-link" style="margin-top: 40px;">Back</a> -->

<div class="govuk-grid-row">

    <main class="govuk-main-wrapper " id="main-content" role="main">

      <div class="govuk-grid-column-one-quarter">

        <h2 class="govuk-heading-m govuk-!-Margin-bottom-5">Filters</h2>

        <div id="filter-hint" class="govuk-hint govuk-!-Marchgin-bottom-4">
          Select one or more filters to apply to the list.
        </div>

        <div class="table-filter">

          <form id="filters" action="index" method="post">

            <!--Filters-->
            <div class="govuk-form-group">

              <fieldset class="govuk-fieldset">

              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                Current status
              </legend>

              <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">

                  <!-- status 1: Claim awarded -->
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input govuk-body" id="status-1" name="current-status" type="checkbox" value="registered">
                    <label class="govuk-label govuk-checkboxes__label " for="status-1">
                      Claim awarded (3)
                    </label>

                  </div>

                   <!-- status 2: Paying claimant -->
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="status-2" name="current-status" type="checkbox" value="health-dis">
                    <label class="govuk-label govuk-checkboxes__label" for="status-2">
                      Paying claimant (2)
                    </label>
                  </div>

                   <!-- status 3: Completed move to PIPCS -->
                  <div class="govuk-checkboxes__item">
                      <input class="govuk-checkboxes__input" id="status-3" name="current-status" type="checkbox" value="submitted">
                      <label class="govuk-label govuk-checkboxes__label" for="status-3">
                        Stopped payment in PIP Service (1)
                      </label>
                  </div>

                  <!-- status 3: Stopped payment in PIP Service -->
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="status-3" name="current-status" type="checkbox" value="submitted">
                    <label class="govuk-label govuk-checkboxes__label" for="status-3">
                      Completed move to PIPCS (3)
                    </label>
                </div>

                  <!-- status 4: Reached award end date -->
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="status-6" name="current-status" type="checkbox" value="referred-ap">
                    <label class="govuk-label govuk-checkboxes__label" for="status-6">
                      Reached award end date (2)
                    </label>
                </div>

                <!-- status 5: Stopped award -->
                <div class="govuk-checkboxes__item">
                  <input class="govuk-checkboxes__input" id="status-7" name="current-status" type="checkbox" value="Returned-ap">
                  <label class="govuk-label govuk-checkboxes__label" for="status-7">
                    Stopped award (1)
                  </label>
              </div>

              <!-- status 6: Paused award -->
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-8" name="current-status" type="checkbox" value="Ready-decision">
                <label class="govuk-label govuk-checkboxes__label" for="status-8">
                  Paused award (3)
                </label>
            </div>
            </div></fieldset>
            </div>

            <button class="govuk-button" xmlns="/view-all-claims/days-in-status/index">
              Apply filters
            </button>

          </form>
        </div>
        </div>

        <div class="govuk-grid-column-three-quarters">

          <h1 class="govuk-heading-xl">View awarded claims</h1>
          <p class="govuk-body govuk-!-font-size-19 govuk-!-margin-bottom-6">Total cases: <b>6</b></p>

          {%- from "govuk/components/table/macro.njk" import govukTable -%}

          {{ govukTable({
            attributes: {
              'data-module': 'moj-sortable-table'
            },
            head: [
              {
                text: "National Insurance number",
                classes:"govuk-!-width-one-quarter"
              },
              {
                text: "Award start date"
              },
              {
                text: "Current status"
              },
              {
                text: "Days in current status",
                attributes: {
                  "aria-sort": "none"
                }
            }
            ],
            rows: [
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 56 82 91 F'
                },
                {
                  text: "30 June 2024"
                },
                {
                  text: "	Paying claimant"
                },
                {
                  text: "15 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 23 64 77 A'
                },
                {
                  text: "30 June 2024"
                },
                {
                  text: "Claim awarded"
                },
                {
                  text: "7 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 12 34 56 C'
                },
                {
                  text: "1 July 2024"
                },
                {
                  text: "Claim awarded"
                },
                {
                  text: "3 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 12 34 56 C'
                },
                {
                  text: "12 July 2024"
                },
                {
                  text: "Stopped payment in PIP Service"
                },
                {
                  text: "2 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 114 60 C'
                },
                {
                  text: "14 May 2024"
                },
                {
                  text: "Reached award end date"
                },
                {
                  text: "4 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ t2 74 36 C'
                },
                {
                  text: "14 June 2024"
                },
                {
                  text: "Completed move to PIPCS"
                },
                {
                  text: "4 days"
                }
              ]
            ]
          }) }}
        </div>
        </div>
    </div>


        <script>

          function hideAllWithClass(classname) {
            document.querySelectorAll("." + classname).forEach((element) => {
              element.style.visibility = 'collapse';
            });
          }

          function showAllWithClass(classname) {
            document.querySelectorAll("." + classname).forEach((element) => {
              element.style.visibility = 'visible';
            });
          }

          document.querySelector("#filters").addEventListener("submit", function (e) {

            e.preventDefault();    //stop form from submitting

            showAllWithClass("status-1");
            showAllWithClass("status-2");
            showAllWithClass("status-3");
            showAllWithClass("status-4");
            showAllWithClass("status-5");
            showAllWithClass("status-6");
            showAllWithClass("status-7");
            showAllWithClass("status-8");
            showAllWithClass("status-9");
            showAllWithClass("status-10");
            showAllWithClass("status-11");
            showAllWithClass("status-12");

            let benefitTypes = [];
            let sites = [];

            if (document.getElementById('srel').checked == true) {
              hideAllWithClass("no-srel");
            }

            if (document.getElementById('pip').checked == true || document.getElementById('esa').checked == true || document.getElementById('uc').checked == true) {
              if (document.getElementById('pip').checked == false) {
                hideAllWithClass("pip");
              } else {
                benefitTypes.push("Personal Independence Payment");
              }

              if (document.getElementById('esa').checked == false) {
                hideAllWithClass("esa");
              } else {
                benefitTypes.push("Employment Support Allowance");
              }

              if (document.getElementById('uc').checked == false) {
                hideAllWithClass("uc");
              } else {
                benefitTypes.push("Universal Credit");
              }
            }

            if (document.getElementById('handsworth').checked == true || document.getElementById('tresco').checked == true) {
              if (document.getElementById('handsworth').checked == false) {
                hideAllWithClass("handsworth");
              } else {
                sites.push("Handsworth");
              }

              if (document.getElementById('tresco').checked == false) {
                hideAllWithClass("tresco");
              } else {
                sites.push('Tresco');
              }
            }

            var count = 0;
            var elemnts = document
              .querySelectorAll('.govuk-table tr').forEach((element) => {
                if (element.style.visibility === 'visible') {
                  count += 1;
                }
              })

            if (count < 20) {
              document.getElementById('pagination').style.visibility = 'collapse';
            } else {
              document.getElementById('pagination').style.visibility = 'visible';
            }

            document.getElementById('paginationTotal').innerText = count;

            // var eol = document.getElementById('srel').checked ? " end of life" : "";
            // var benefitTypeString = benefitTypes.join(", ");
            // var sitesString = sites.join(", ");
            // var ifBenefitType = benefitTypes.length > 0 ? ' for ' : '';
            // var ifSites = sites.length > 0 ? ' at ' : '';

            //11 HCP review end of life referrals in PIP, ESA, UC at Birmingham Handsworth
            // var text = count + " report ready " + eol + " referrals " + ifBenefitType + benefitTypeString + ifSites + sitesString;
            var text = count + " referrals";

            document.getElementById('filter-playback').innerText = text;

            // document.getElementById('srelCount').innertext = document.querySelectorAll('.govuk-table tr.srel').length;

          });

        </script>

{% endblock %}
