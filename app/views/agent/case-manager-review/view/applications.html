{% extends "agent/case-manager-review/includes/layout.html" %}

{% block pageTitle %} View all applications {% endblock %}

{% set pageStatus="Work in progress" %}
{% set teamName="Pelican" %}
{% set pageNotes="Current status filters being added" %}

{% block main %}

<div class="govuk-width-container">

<!-- <a href="javascript:history.go(-1)" class="govuk-back-link" style="margin-top: 40px;">Back</a> -->

<div class="govuk-grid-row">

    <main class="govuk-main-wrapper " id="main-content" role="main">

      <div class="govuk-grid-column-one-quarter">

    <h2 class="govuk-heading-m govuk-!-Margin-bottom-5">Filters</h2>

    <div id="filter-hint" class="govuk-hint govuk-!-Marchgin-bottom-4">
      Select one or more filters to apply to the list.
    </div>

    <div class="table-filter">

      <form id="filters" action="index" method="post">

        <!--Filters-->
        <div class="govuk-form-group">

          <fieldset class="govuk-fieldset">

          <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
            Current status
          </legend>

          <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">

              <!-- REMOVED START OF CLAIM -->

               <!-- status 2: Started health information gather -->
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-2" name="current-status" type="checkbox" value="health-dis">
                <label class="govuk-label govuk-checkboxes__label" for="status-2">
                  Started health information gather (1)
                </label>
              </div>

               <!-- status 3: Received health information gather -->
              <div class="govuk-checkboxes__item">
                  <input class="govuk-checkboxes__input" id="status-3" name="current-status" type="checkbox" value="submitted">
                  <label class="govuk-label govuk-checkboxes__label" for="status-3">
                    Received health information gather (1)
                  </label>
              </div>

              <!-- status 4: Referred to assessment provider -->
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="status-6" name="current-status" type="checkbox" value="referred-ap">
                <label class="govuk-label govuk-checkboxes__label" for="status-6">
                  Referred to assessment provider (1)
                </label>
            </div>

            <!-- status 5: Returned from assessment provider -->
            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input" id="status-7" name="current-status" type="checkbox" value="Returned-ap">
              <label class="govuk-label govuk-checkboxes__label" for="status-7">
                Returned from assessment provider (1)
              </label>
          </div>

          <!-- status 6: Ready for decision -->
          <div class="govuk-checkboxes__item">
            <input class="govuk-checkboxes__input" id="status-8" name="current-status" type="checkbox" value="Ready-decision">
            <label class="govuk-label govuk-checkboxes__label" for="status-8">
              Ready for decision (3)
            </label>
        </div>

        <!-- status 7: Decision made: awarded -->
        <div class="govuk-checkboxes__item">
          <input class="govuk-checkboxes__input" id="status-9" name="current-status" type="checkbox" value="awarded">
          <label class="govuk-label govuk-checkboxes__label" for="status-9">
            Decision made: awarded (1)
          </label>
          </div>

           <!-- status 8: Decision made: not awarded -->
           <div class="govuk-checkboxes__item">
            <input class="govuk-checkboxes__input" id="status-10" name="current-status" type="checkbox" value="not-awarded">
            <label class="govuk-label govuk-checkboxes__label" for="status-10">
              Decision made: not awarded
            </label>
        </div>

        <!-- status 9: Moved to PIPCS -->
        <div class="govuk-checkboxes__item">
          <input class="govuk-checkboxes__input" id="status-12" name="moved-to-PIPCS" type="checkbox" value="moved-to-PIPCS">
          <label class="govuk-label govuk-checkboxes__label" for="status-12">
            Moved to PIPCS (3)
          </label>
      </div>

        <!-- status 10: Disallowed: not eligible -->
         <!-- <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="status-4" name="current-status" type="checkbox" value="not-eligible">
                    <label class="govuk-label govuk-checkboxes__label" for="status-4">
                      Disallowed: not eligible
                    </label>
         </div> -->

       <!-- status 11 Disallowed: failure to comply -->
          <div class="govuk-checkboxes__item">
                  <input class="govuk-checkboxes__input" id="status-4" name="current-status" type="checkbox" value="failure-to-comply">
                  <label class="govuk-label govuk-checkboxes__label" for="status-4">
                    Disallowed: failure to comply (1)
                  </label>
          </div>

       <!-- status 12: Withdrawn -->
        <!-- <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input" id="status-5" name="current-status" type="checkbox" value="Withdrawn">
              <label class="govuk-label govuk-checkboxes__label" for="status-5">
                Withdrawn (1)
              </label>
       </div> -->

        </div></fieldset>
        </div>

        <button class="govuk-button" xmlns="/view-all-claims/days-in-status/index">
          Apply filters
        </button>

      </form>

    </div>

    </div>

        <div class="govuk-grid-column-three-quarters">

          <h1 class="govuk-heading-xl">View all applications</h1>
          <p class="govuk-body govuk-!-font-size-19 govuk-!-margin-bottom-6">Total cases: <b>4</b></p>

          {%- from "govuk/components/table/macro.njk" import govukTable -%}

          {{ govukTable({
            attributes: {
              'data-module': 'moj-sortable-table'
            },
            head: [
              {
                text: "National Insurance number",
                classes:"govuk-!-width-one-quarter"
              },
              {
                text: "Date of claim"
              },
              {
                text: "Current status"
              },
              {
                text: "Days in current status",
                attributes: {
                  "aria-sort": "none"
                }
            }
            ],
            rows: [
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 56 82 91 F'
                },
                {
                  text: "30 June 2024"
                },
                {
                  text: "Started health information gather"
                },
                {
                  text: "15 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 23 64 77 A'
                },
                {
                  text: "30 June 2024"
                },
                {
                  text: "Moved to PIPCS"
                },
                {
                  text: "7 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 12 34 56 C'
                },
                {
                  text: "1 July 2024"
                },
                {
                  text: "Ready for decision"
                },
                {
                  text: "3 days"
                }
              ],
              [
                {
                  html: '<a href="../personal-details" class="govuk-link">QQ 114 60 C'
                },
                {
                  text: "14 May 2024"
                },
                {
                  text: "Disallowed: failure to comply"
                },
                {
                  text: "4 days"
                }
              ]
            ]
          }) }}
        </div>
        </div>
    </div>


        <script>

          function hideAllWithClass(classname) {
            document.querySelectorAll("." + classname).forEach((element) => {
              element.style.visibility = 'collapse';
            });
          }

          function showAllWithClass(classname) {
            document.querySelectorAll("." + classname).forEach((element) => {
              element.style.visibility = 'visible';
            });
          }

          document.querySelector("#filters").addEventListener("submit", function (e) {

            e.preventDefault();    //stop form from submitting

            showAllWithClass("status-1");
            showAllWithClass("status-2");
            showAllWithClass("status-3");
            showAllWithClass("status-4");
            showAllWithClass("status-5");
            showAllWithClass("status-6");
            showAllWithClass("status-7");
            showAllWithClass("status-8");
            showAllWithClass("status-9");
            showAllWithClass("status-10");
            showAllWithClass("status-11");
            showAllWithClass("status-12");

            let benefitTypes = [];
            let sites = [];

            if (document.getElementById('srel').checked == true) {
              hideAllWithClass("no-srel");
            }

            if (document.getElementById('pip').checked == true || document.getElementById('esa').checked == true || document.getElementById('uc').checked == true) {
              if (document.getElementById('pip').checked == false) {
                hideAllWithClass("pip");
              } else {
                benefitTypes.push("Personal Independence Payment");
              }

              if (document.getElementById('esa').checked == false) {
                hideAllWithClass("esa");
              } else {
                benefitTypes.push("Employment Support Allowance");
              }

              if (document.getElementById('uc').checked == false) {
                hideAllWithClass("uc");
              } else {
                benefitTypes.push("Universal Credit");
              }
            }

            if (document.getElementById('handsworth').checked == true || document.getElementById('tresco').checked == true) {
              if (document.getElementById('handsworth').checked == false) {
                hideAllWithClass("handsworth");
              } else {
                sites.push("Handsworth");
              }

              if (document.getElementById('tresco').checked == false) {
                hideAllWithClass("tresco");
              } else {
                sites.push('Tresco');
              }
            }

            var count = 0;
            var elemnts = document
              .querySelectorAll('.govuk-table tr').forEach((element) => {
                if (element.style.visibility === 'visible') {
                  count += 1;
                }
              })

            if (count < 20) {
              document.getElementById('pagination').style.visibility = 'collapse';
            } else {
              document.getElementById('pagination').style.visibility = 'visible';
            }

            document.getElementById('paginationTotal').innerText = count;

            // var eol = document.getElementById('srel').checked ? " end of life" : "";
            // var benefitTypeString = benefitTypes.join(", ");
            // var sitesString = sites.join(", ");
            // var ifBenefitType = benefitTypes.length > 0 ? ' for ' : '';
            // var ifSites = sites.length > 0 ? ' at ' : '';

            //11 HCP review end of life referrals in PIP, ESA, UC at Birmingham Handsworth
            // var text = count + " report ready " + eol + " referrals " + ifBenefitType + benefitTypeString + ifSites + sitesString;
            var text = count + " referrals";

            document.getElementById('filter-playback').innerText = text;

            // document.getElementById('srelCount').innertext = document.querySelectorAll('.govuk-table tr.srel').length;

          });

        </script>

{% endblock %}
